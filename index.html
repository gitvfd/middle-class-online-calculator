
<!doctype html>
<html>
<meta charset="utf-8">

<head>
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="libs/d3.v4.min.js"></script>
    <script src="js/update.js"></script>
    <script src="js/compare.js"></script>
</head>

<body id="page">

<div id="wrapper">
    <div id="selector">
        <h1 >See where you belong by entering your details!</h1>
        <div class="selTitle">Country:</div>
        <select class="dropdownSel" id="ctrSel" onchange="update()">
            <option value="AUS" >Australia</option>
            <option value="AUT">Austria</option>
            <option value="BEL">Belgium</option>
            <option value="BRA">Brazil</option>
            <option value="CAN">Canada</option>
            <option value="CHN">China</option>
            <option value="CHL">Chile</option>
            <option value="CZE">Czech Republic</option>
            <option value="DNK">Denmark</option>
            <option value="EST">Estonia</option>
            <option value="FIN">Finland</option>
            <option value="FRA">France</option>
            <option value="DEU">Germany</option>
            <option value="GRC">Greece</option>
            <option value="HUN">Hungary</option>
            <option value="ISL">Iceland</option>
            <option value="IND">India</option>
            <option value="IRL">Ireland</option>
            <option value="ISR">Israel</option>
            <option value="ITA">Italy</option>
            <option value="JPN">Japan</option>
            <option value="KOR">Korea</option>
            <option value="LVA">Latvia</option>
            <option value="LTU">Lithuania</option>
            <option value="LUX">Luxembourg</option>
            <option value="MEX">Mexico</option>
            <option value="NLD">Netherlands</option>
            <option value="NOR">Norway</option>
            <option value="POL">Poland</option>
            <option value="PRT">Portugal</option>
            <option value="RUS">Russian Federation</option>
            <option value="SVK">Slovakia</option>
            <option value=SVN>Slovenia</option>
            <option value="ZAF">South Africa</option>
            <option value="ESP">Spain</option>
            <option value="SWE">Sweden</option>
            <option value="CHE">Switzerland</option>
            <option value="TUR">Turkey</option>
            <option value="GBR">United Kingdom</option>
            <option value="USA">United States</option>
        </select>
        <!--<div class="selTitle">Your familly structure:</div>
        <select class="dropdownSel" id="criSelector" onchange="update()">
                <option value="Population share by income class">-</option>
                <option value="family type: single adult">family type:single adult</option>
                <option value="family type: single parent">family type:single parent</option>
                <option value="family type: couple with children">family type:couple with children</option>
                <option value="family type: couple with no children">family type:couple with no children</option>
            </select>-->
        <div class="selTitle">How many persons live in your household:</div>
        <select class="dropdownSel" id="householdSize" onchange="update()">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
        </select>
        <!--<div class="rangeslider">
            <input type="range" min="1" max="10" value="1" class="myslider" id="sliderRange">
            <p id="rangehhs">Value: <span id="householdSize"></span></p>
        </div>-->
        <div class="selTitle">Your income after taxes and benefits:<br/> <i>(in national currency)</i></div>
        <form>
            <label class="radio"><input type="radio"  id="yearlyRadio" name="incomeCalc" value="1" onclick="update()" checked> Yearly</label>
            <label class="radio"><input type="radio"  id="monthlyRadio" name="incomeCalc" value="12" onclick="update()" > Monthly</label>
        </form>
        <input id="incomeSel" type="text" onfocus="this.value=''" value="Type your income then press Enter" onchange="update()"><br>
        <br/>
        <!--<div id="compareButton">
            <div class="selTitle"><i>Compare 2 country class distributions:</i></div>
            <button  onclick="openDiv()">Compare</button>
        </div>-->
    </div>
    <div id="chart">
        <br>
        <div id="year2010s">Which income class does your family income fits in?</div>
        <div id="chart2010s"></div>
        <br>
        <div id="sentence">
            According to the income and number of people in your household, <b>you</b> are in the <span class="highlight" id="calcClass">middle-income class</span> in <span class="highlight" id="calcCou">Australia</span>.
            <br/>
            In <span class="highlight" id="calcCou2">Australia</span>, a <span class="highlight" id="calcHhSize">1-person</span> household would need between <span class="highlight" id="calcLowThreshold"></span> and <span class="highlight" id="calcUpThreshold"></span> per <span class="highlight" id="calcPeriod">year</span> to be in the middle-income class.
            <br/>
            <br />
            In <span class="highlight" id="calcCou3">Australia</span>, <span class="highlight" id="middleClassVal">58%</span>
            of the population is in the middle-income class,  <span class="highlight" id="lowClassVal">32%</span> are in the lower-income class and <span class="highlight"
                id="upClassVal"> 10%</span> are in the upper-income class. On average, across OECD countries, <span class="highlight" id="middleClassValOECD">61%</span>
                are in the middle-income class, <span class="highlight" id="lowClassValOECD">30%</span> are in the
                lower-income class and <span class="highlight" id="upClassValOECD"> 9%</span> are in the upper-income class.
            <br />
            <br/>
            <i>Between mid-2000s and mid-2010s in <span class="highlight" id="calcCou4">Australia</span>:</i>
            <ul>
                <li>
                The share of the population in the middle-income class has <span class="highlight" id="calcMidEvo">increased</span> by <span class="highlight" id="calcMidEvoVal">7</span> percentage points.
                </li>
                <li>
                The upper-income class has <span class="highlight" id="calcUpEvo">increased</span> by <span class="highlight"
                    id="calcUpEvoVal">7</span> percentage points.
                </li>
                <li>
                The lower-income class has <span class="highlight" id="calcLowEvo">increased</span> by <span class="highlight"
                    id="calcLowEvoVal">7</span> percentage points.
                </li>
            </ul>
             </div>
            <div id="compareButton">
                <!--<div class="selTitle"><i>Compare 2 country class distributions:</i></div>-->
                <button onclick="openDiv()">Compare 2 country class distributions</button>
            </div>
    </div>
</div>
<br/>

<br/>
<div id=comparaison>
    <button id="closeButton">close</button>
    <div class="selTitle">Compare the class distribution in <span id="selCouName">Australia</span> to</div>
    <select class="dropdownSel2" id="compareSel" onchange="compare()">
        <option value="AUS">Australia</option>
        <option value="AUT">Austria</option>
        <option value="BEL">Belgium</option>
        <option value="BRA">Brazil</option>
        <option value="CAN">Canada</option>
        <option value="CHN">China</option>
        <option value="CHL">Chile</option>
        <option value="CZE">Czech Republic</option>
        <option value="DNK">Denmark</option>
        <option value="EST">Estonia</option>
        <option value="FIN">Finland</option>
        <option value="FRA">France</option>
        <option value="DEU">Germany</option>
        <option value="GRC">Greece</option>
        <option value="HUN">Hungary</option>
        <option value="ISL">Iceland</option>
        <option value="IND">India</option>
        <option value="IRL">Ireland</option>
        <option value="ISR">Israel</option>
        <option value="ITA">Italy</option>
        <option value="JPN">Japan</option>
        <option value="KOR">Korea</option>
        <option value="LVA">Latvia</option>
        <option value="LTU">Lithuania</option>
        <option value="LUX">Luxembourg</option>
        <option value="MEX">Mexico</option>
        <option value="NLD">Netherlands</option>
        <option value="NOR">Norway</option>
        <option value="POL">Poland</option>
        <option value="PRT">Portugal</option>
        <option value="RUS">Russian Federation</option>
        <option value="SVK">Slovakia</option>
        <option value=SVN>Slovenia</option>
        <option value="ZAF">South Africa</option>
        <option value="ESP">Spain</option>
        <option value="SWE">Sweden</option>
        <option value="CHE">Switzerland</option>
        <option value="TUR">Turkey</option>
        <option value="GBR">United Kingdom</option>
        <option value="USA">United States</option>
        <option value="OECD" selected>OECD</option>
    </select>
    <br/>

    <div id="chartCompare"></div>
</div>
</body>
<script>
        var dataTot = [];
        
        var counter = 0;


        d3.tsv("data/data.tsv", function (error, data) {
            data.forEach(function (d) {
                dataTot.push(d)
                counter++;
                if (counter === data.length) {
                    update();
                }
            })
        });


    var width = document.getElementById("chart2010s").offsetWidth;

    var widthCompare = 0.8*document.getElementById("page").offsetWidth;

    var height= 100;
    var heightCompare = 200;
    var margin=10;

    const x = d3.scaleLinear()
                .domain([0, 100])
                .range([1, width]).nice()


    const xCompare = d3.scaleLinear()
        .domain([0, 100])
        .range([1, widthCompare]).nice()

    var scaleClass =d3.scaleOrdinal()
                .domain(["Lower","Middle","Upper"])
                .range(["#4FF1EE", "#43A5B4", "#356072"]);

    var scaleClassCompare = d3.scaleOrdinal()
        .domain(["Lower", "Middle", "Upper"])
        .range(["#4ff19d", "#43b48b", "#357266"]);

    var svg2010s = d3.select("#chart2010s")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "none");

    var svgcompare= d3.select("#chartCompare")
        .append("svg")
        .attr("width", widthCompare)
        .attr("height", heightCompare)
        .style("background", "none");

    var format = d3.format(",.0f");
    

    function openDiv(){
        document.getElementById("comparaison").style.display = "block";
    }
    document.getElementById('closeButton').addEventListener('click', function (e) {
            e.preventDefault();
            this.parentNode.style.display = 'none';
        }, false);
</script>
</html>